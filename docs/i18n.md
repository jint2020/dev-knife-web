# DevKnife Web - Internationalization (i18n)

## Overview

DevKnife Web uses **react-i18next** for internationalization, supporting multiple languages with an offline-first approach.

## Supported Languages

- **English** (`en`) - Default
- **Chinese** (`zh`)

## Architecture

### 1. Translation Files

Translation resources are defined as **TypeScript objects** (not JSON files) for better type safety and offline support:

```
src/i18n/
â”œâ”€â”€ config.ts          # i18next initialization
â”œâ”€â”€ index.ts           # Module exports
â””â”€â”€ locales/
    â”œâ”€â”€ en.ts          # English translations
    â””â”€â”€ zh.ts          # Chinese translations
```

### 2. Configuration

**Location**: `src/i18n/config.ts`

Key features:
- **Offline-first**: Translations are bundled, no HTTP requests
- **Browser language detection**: Automatically detects user's preferred language
- **localStorage persistence**: Remembers user's language choice
- **Fallback**: Defaults to English if translation is missing

### 3. Language Detection Order

1. **localStorage**: `devknife-language` key
2. **Browser settings**: `navigator.language`
3. **Fallback**: English (`en`)

## Usage

### 1. Basic Translation

```tsx
import { useTranslation } from 'react-i18next';

export function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('welcome.title')}</h1>
      <p>{t('welcome.description')}</p>
    </div>
  );
}
```

### 2. Language Switcher

The `LanguageSwitcher` component is available in the Header:

```tsx
import { LanguageSwitcher } from '@/components/layout/LanguageSwitcher';

// Usage in Header
<LanguageSwitcher />
```

### 3. Programmatic Language Change

```tsx
import { useTranslation } from 'react-i18next';

const { i18n } = useTranslation();

// Change language
i18n.changeLanguage('zh'); // Switch to Chinese
i18n.changeLanguage('en'); // Switch to English
```

## Adding New Translations

### Step 1: Add to English (`en.ts`)

```ts
export const en = {
  translation: {
    myFeature: {
      title: 'My Feature',
      description: 'Feature description',
    },
  },
};
```

### Step 2: Add to Chinese (`zh.ts`)

```ts
export const zh = {
  translation: {
    myFeature: {
      title: 'æˆ‘çš„åŠŸèƒ½',
      description: 'åŠŸèƒ½æè¿°',
    },
  },
};
```

### Step 3: Use in Components

```tsx
const { t } = useTranslation();
<h1>{t('myFeature.title')}</h1>
```

## Adding New Languages

### Step 1: Create Translation File

Create `src/i18n/locales/[languageCode].ts`:

```ts
export const fr = {
  translation: {
    // ... translations
  },
};
```

### Step 2: Update Config

In `src/i18n/config.ts`:

```ts
import { fr } from './locales/fr';

const resources = {
  en,
  zh,
  fr, // Add new language
};

export const SUPPORTED_LANGUAGES = [
  { code: 'en', name: 'English', nativeName: 'English' },
  { code: 'zh', name: 'Chinese', nativeName: 'ä¸­æ–‡' },
  { code: 'fr', name: 'French', nativeName: 'FranÃ§ais' }, // Add new language
];
```

### Step 3: Export in Index

In `src/i18n/index.ts`:

```ts
export { fr } from './locales/fr';
```

## Translation Keys Structure

```
translation
â”œâ”€â”€ app              # App metadata
â”œâ”€â”€ nav              # Navigation & search
â”œâ”€â”€ common           # Common UI elements
â”œâ”€â”€ theme            # Theme-related text
â”œâ”€â”€ language         # Language names
â”œâ”€â”€ sidebar          # Sidebar-specific text
â”œâ”€â”€ categories       # Tool categories
â”œâ”€â”€ welcome          # Welcome screen
â””â”€â”€ errors           # Error messages
```

## Best Practices

1. **Namespace Organization**: Group related translations together
2. **Consistent Keys**: Use camelCase for translation keys
3. **Descriptive Names**: Make keys self-explanatory
4. **Avoid Duplication**: Reuse common translations (e.g., `common.copy`)
5. **Type Safety**: TypeScript ensures all translations match structure

## Initialization

i18n is initialized in `src/main.tsx`:

```tsx
import './i18n/config'; // Initialize before rendering
```

This ensures translations are available before any component renders.

## Components Using i18n

- **Header**: GitHub link tooltip
- **LanguageSwitcher**: Language selection dropdown
- **CommandPalette**: Search placeholder and results
- **App**: Welcome screen text
- (More components to be added)

## Testing Language Switching

1. Click the **Languages** icon (ğŸŒ) in the Header
2. Select **ä¸­æ–‡** or **English**
3. Language preference is saved to localStorage
4. Page text updates immediately (no refresh needed)

## Troubleshooting

### Translations Not Loading

- Verify import in `main.tsx`: `import './i18n/config'`
- Check browser console for i18next errors
- Ensure translation keys exist in both language files

### Language Not Persisting

- Check localStorage for `devknife-language` key
- Clear browser cache if needed
- Verify detection configuration in `config.ts`

## Dependencies

- `i18next`: Core internationalization framework
- `react-i18next`: React bindings for i18next
- `i18next-browser-languagedetector`: Automatic language detection

Install with:
```bash
npm install i18next react-i18next i18next-browser-languagedetector
```
